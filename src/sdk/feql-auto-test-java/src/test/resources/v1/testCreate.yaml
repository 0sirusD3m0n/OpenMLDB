db: test_zw
debugs: ["创建两个相同时间列的索引的表"]
cases:
  -
    id: 1
    desc: 创建所有类型的表
    inputs:
      -
        columns : ["c1 string","c2 smallint","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c1:c7"]
        rows:
          - ["aa",1,2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c2 smallint","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",1,2,3,1.1,2.1,1590738989000,"2020-05-01"]
  -
    id: 2
    desc: 创建两个相同时间列的索引的表
    inputs:
      -
        columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
        sql: |
          create table {ran}(
          c1 string,
          c2 int,
          c3 timestamp,
          c4 timestamp,
          index(key=(c1),ts=c4),
          index(key=(c2),ts=c4));
        rows:
          - ["aa",1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 3
    desc: 创建两个不同时间列的索引的表
    inputs:
      -
        columns : ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4","index2:c2:c3"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 4
    desc: 创建一个联合索引的表
    inputs:
      -
        columns : ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1,c2:c4"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 5
    desc: NotNull的列为index
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 6
    desc: 指定ttl
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4:3650d"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 7
    desc: ttl=0
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4:0"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 8
    desc: ttl=-1
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4:-1"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 9
    desc: ttl为字符
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=aa));
    expect:
      success: false
  -
    id: 10
    desc: 指定ttl_type=absolute
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4:0:absolute"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 11
    desc: 指定ttl_type=latest
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4:0:latest"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 int","c3 timestamp","c4 timestamp"]
  -
    id: 12
    desc: 指定ttl_type为其他字符
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0,ttl_type=aaa));
    expect:
      success: false
  -
    id: 13
    desc: 表名以数字开头
    sql: create table 1aaa(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 14
    desc: 表名为保留关键字
    sql: create table table(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 15
    desc: 列名以数字开头
    sql: create table auto_kJKytImk(1c string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 16
    desc: 列名为保留关键字
    sql: create table auto_kJKytImk(use string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 17
    desc: 语句缺少分号
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0))
    expect:
      success: false
  -
    id: 18
    desc: 列的类型不存在
    sql: create table auto_kJKytImk(c1 varchar2 NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0))
    expect:
      success: false
  -
    id: 19
    desc: index指定的col不存在
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c5),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 20
    desc: index指定的ts不存在
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c5,ttl=0));
    expect:
      success: false
  -
    id: 21
    desc: 创建的index不指定ts
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1)));
    expect:
      success: false
  -
    id: 22
    desc: 创建index不指定col
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 23
    desc: 指定的ts为其他类型
    sql: create table auto_kJKytImk(c1 string NOT NULL,c2 string,c3 timestamp,c4 timestamp,index(key=(c1),ts=c2,ttl=0));
    expect:
      success: false
  -
    id: 24
    desc: 表名使用特殊字符
    sql: create table auto$#kJKytImk(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 25
    desc: 列名使用特殊字符
    sql: create table auto_kJKytImk(c1$# string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 26
    desc: 指定的ts为bigint
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 bigint","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c2"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 bigint","c3 timestamp","c4 timestamp"]
  -
    id: 27
    desc: 指定的ts为bigint+ttl
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 bigint","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c2:0"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 bigint","c3 timestamp","c4 timestamp"]
  -
    id: 28
    desc: 创建已经存在的表
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 bigint","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c4"]
    sql: create table {0}(c1 string NOT NULL,c2 int,c3 timestamp,c4 timestamp,index(key=(c1),ts=c4,ttl=0));
    expect:
      success: false
  -
    id: 29
    desc: 指定的ts为int
    inputs:
      -
        columns : ["c1 string NOT NULL","c2 int","c3 timestamp","c4 timestamp"]
        indexs: ["index1:c1:c2:0"]
        rows:
          - [aa,1,1590738990000,1590738989000]
    sql: select * from {0};
    expect:
      columns: ["c1 string","c2 bigint","c3 timestamp","c4 timestamp"]
  -
    id: 30
    desc: bigint为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c4:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
  -
    id: 31
    desc: int为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c3:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
  -
    id: 32
    desc: timestamp为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c7:c4"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
  -
    id: 33
    desc: date为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c8:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
  -
    id: 34
    desc: float为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c5:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      success: false
  -
    id: 35
    desc: double为索引列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c6:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      success: false
  -
    id: 36
    desc: key和ts为同一列
    inputs:
      -
        columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c7:c7"]
        rows:
          - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]
    sql: select * from {0};
    expect:
      columns : ["c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
      rows:
         - ["aa",2,3,1.1,2.1,1590738989000,"2020-05-01"]