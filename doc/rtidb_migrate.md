# rtidb 升级脚本

## 停止写入流量

## env.sh

配置文件里面有3个参数
* rtidb_bin_path 指定rtidb bin路径
* zk_cluster 指定zk cluster的地址
* zk_root_path 指定zk root path的地址

## 分析功能

分析命令用于显示，重启一个tablet前需要的操作
```
# 如果要升级127.0.0.1:9527这个节点，对其进行分析操作
./analysis.sh 127.0.0.1:9527
```

## 迁移主节点操作

将一个节点的主节点都迁移到副本上面, 会一个分片一个分片操作，每次操作都需要人工确认

```
./changeleader.sh 127.0.0.1:9527
```

## 恢复故障节点

如果重启完成，恢复以前的副本, 这里也是一步一步操作
```
./recovertable.sh 127.0.0.1:9527 
```

## 恢复整个集群的数据
如果重启完成，可以执行下面命令恢复数据内容，只需要执行一步即可
```
./recoverdata.sh
```

## 将主节点进行迁回

## 在此恢复follower节点

## 恢复写入流量
