cases:
  - id: 0
    desc: fz sql 子查询
    db: db1
    mode: rtidb-unsupport, request-unsupport
    sql: |
      select
          c1,
          min(c1) over table_1_s2_t1 as table_1_c1_9,
          min(c2) over table_1_s2_t1 as table_1_c2_10,
          identity(case when at(d1, 1) != null then distinct_count(d1) else null end) over table_1_s2_t1 as table_1_d1_11,
          identity(case when at(d2, 1) != null then distinct_count(d2) else null end) over table_1_s2_t1 as table_1_d2_12,
          identity(case when at(s1, 1) != null then distinct_count(s1) else null end) over table_1_s2_t1 as table_1_s1_13
      from
          (select '' as s1, s2 as s2, t1 as t1, date('2019-07-18') as t2, string(0) as d1, string(0) as d2, int(0) as c1, bigint(0) as c2, '' as ai, '' as kn, '' as ks from main)
          window table_1_s2_t1 as (
      UNION (select s1, s2, t1, t2, d1, d2, c1, c2, ai, kn, ks from table_1) partition by s2 order by t1 rows_range between 1d preceding and 0s preceding);
    inputs:
      - name: main
        schema: label:int,s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1,index2:s1:t1,index3:d1:t1,index4:d2:t1
        data: |
          1, 1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_1
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_2
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_3
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
    expect:
      schema: col2:int16, col5:int64, w1_col1_sum:int32, w1_col3_sum:float, w1_col4_sum:double, w1_col2_sum:int16, w1_col5_sum:int64, w1_col1_cnt:int64, col1:int32, col6:string
      order: col1
      data: |
        5, 2, 2, 2.1, 21.1, 10, 3, 2, 1, 1
        5, 4, 5, 5.3, 53.3, 15, 9, 3, 2, 22
        55, 2, 6, 6.3, 63.3, 110, 3, 2, 3, 333
        55, 4, 11, 11.7, 117.7, 165, 9, 3, 4, 4444
        55,6, 14, 14.9, 149.9, 165, 15, 3, 5, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
  
  - id: 1
    desc: 主表window
    db: db1
    mode: rtidb-unsupport, request-unsupport
    sql: |
      select
          c1,
          min(c1) over table_1_s2_t1 as table_1_c1_9,
          min(c2) over table_1_s2_t1 as table_1_c2_10,
          identity(case when at(d1, 1) != null then distinct_count(d1) else null end) over table_1_s2_t1 as table_1_d1_11,
          identity(case when at(d2, 1) != null then distinct_count(d2) else null end) over table_1_s2_t1 as table_1_d2_12,
          identity(case when at(s1, 1) != null then distinct_count(s1) else null end) over table_1_s2_t1 as table_1_s1_13
      from
          main
          window table_1_s2_t1 as (partition by s2 order by t1 rows_range between 1d preceding and 0s preceding);
    inputs:
      - name: main
        schema: label:int,s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1,index2:s1:t1,index3:d1:t1,index4:d2:t1
        data: |
          1, 1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_1
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_2
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_3
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
    expect:
      schema: col2:int16, col5:int64, w1_col1_sum:int32, w1_col3_sum:float, w1_col4_sum:double, w1_col2_sum:int16, w1_col5_sum:int64, w1_col1_cnt:int64, col1:int32, col6:string
      order: col1
      data: |
        5, 2, 2, 2.1, 21.1, 10, 3, 2, 1, 1
        5, 4, 5, 5.3, 53.3, 15, 9, 3, 2, 22
        55, 2, 6, 6.3, 63.3, 110, 3, 2, 3, 333
        55, 4, 11, 11.7, 117.7, 165, 9, 3, 4, 4444
        55,6, 14, 14.9, 149.9, 165, 15, 3, 5, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa


  - id: 2
    desc: 主表window 添加 INSTANCE_NOT_IN_WINDOW 没有明显错误日志
    db: db1
    mode: rtidb-unsupport, request-unsupport
    sql: |
      select
          c1,
          min(c1) over table_1_s2_t1 as table_1_c1_9,
          min(c2) over table_1_s2_t1 as table_1_c2_10,
          identity(case when at(d1, 1) != null then distinct_count(d1) else null end) over table_1_s2_t1 as table_1_d1_11,
          identity(case when at(d2, 1) != null then distinct_count(d2) else null end) over table_1_s2_t1 as table_1_d2_12,
          identity(case when at(s1, 1) != null then distinct_count(s1) else null end) over table_1_s2_t1 as table_1_s1_13
      from
          main
          window table_1_s2_t1 as (partition by s2 order by t1 rows_range between 1d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW);
    inputs:
      - name: main
        schema: label:int,s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1,index2:s1:t1,index3:d1:t1,index4:d2:t1
        data: |
          1, 1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_1
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_2
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_3
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
    expect:
      schema: col2:int16, col5:int64, w1_col1_sum:int32, w1_col3_sum:float, w1_col4_sum:double, w1_col2_sum:int16, w1_col5_sum:int64, w1_col1_cnt:int64, col1:int32, col6:string
      order: col1
      data: |
        5, 2, 2, 2.1, 21.1, 10, 3, 2, 1, 1
        5, 4, 5, 5.3, 53.3, 15, 9, 3, 2, 22
        55, 2, 6, 6.3, 63.3, 110, 3, 2, 3, 333
        55, 4, 11, 11.7, 117.7, 165, 9, 3, 4, 4444
        55,6, 14, 14.9, 149.9, 165, 15, 3, 5, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

  - id: 3
    desc: lastjoin 测试
    db: db1
    mode: rtidb-unsupport, request-unsupport
    sql: |
      select
          main.c1,
          table_1_s2.c1,
          table_1_s2.s1 as table_1_s1_0,
          table_1_s2.t1 as table_1_t1_1,
          table_1_s2.t2 as table_1_t2_2,
          table_1_s2__t1_0_10.c1 as table_1_c1_3,
          table_1_s2__t1_0_10.c2 as table_1_c2_4,
          table_1_s2__t1_0_10.d1 as table_1_d1_5,
          table_1_s2__t1_0_10.d2 as table_1_d2_6
      from
          main
          last join table_1 as table_1_s2 on main.s2 = table_1_s2.s2
          last join table_1 as table_1_s2__t1_0_10 order by table_1_s2__t1_0_10.t1 on main.s2 = table_1_s2__t1_0_10.s2;
    inputs:
      - name: main
        schema: label:int,s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1,index2:s1:t1,index3:d1:t1,index4:d2:t1
        data: |
          1, 1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_1
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_2
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_3
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
    expect:
      schema: col2:int16, col5:int64, w1_col1_sum:int32, w1_col3_sum:float, w1_col4_sum:double, w1_col2_sum:int16, w1_col5_sum:int64, w1_col1_cnt:int64, col1:int32, col6:string
      order: col1
      data: |
        5, 2, 2, 2.1, 21.1, 10, 3, 2, 1, 1
        5, 4, 5, 5.3, 53.3, 15, 9, 3, 2, 22
        55, 2, 6, 6.3, 63.3, 110, 3, 2, 3, 333
        55, 4, 11, 11.7, 117.7, 165, 9, 3, 4, 4444
        55,6, 14, 14.9, 149.9, 165, 15, 3, 5, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

  - id: 4
    desc: 主表多个window测试
    db: db1
    mode: rtidb-unsupport, request-unsupport
    sql: |
      select
          c1,
          label as main_label_0,
          s1 as main_s1_1,
          s2 as main_s2_2,
          t1 as main_t1_3,
          t2 as main_t2_4,
          d1 as main_d1_5,
          d2 as main_d2_6,
          c1 as main_c1_7,
          c2 as main_c2_8,
          d2 as main_d2_40,
          d2 as main_d2_41,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_s2_t1_0_100 as main_s1_42,
          s1 as main_s1_46,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s1_t1_0s_1d as main_d2_48,
          s2 as main_s2_51,
          d1 as main_d1_51,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s2_t1_0_100 as main_d2_53,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_s1_t1_0s_32d as main_s2_57,
          c1 as main_c1_58,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s1_t1_0s_32d as main_d1_59,
          s1 as main_s1_63,
          d2 as main_d2_63,
          c1 as main_c1_65,
          c1 as main_c1_74,
          max(c2) over main_s2_t1_0s_32d as main_c2_75,
          s1 as main_s1_76,
          s2 as main_s2_76,
          d1 as main_d1_77,
          c2 as main_c2_78,
          sum(c2) over main_d1_t1_0_100 as main_c2_79,
          s1 as main_s1_80,
          s2 as main_s2_80,
          d1 as main_d1_80,
          max(c2) over main_d1_t1_0s_32d as main_c2_83,
          max(c2) over main_d2_t1_0_100 as main_c2_84,
          c1 as main_c1_87,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_s1_t1_0_10 as main_s2_89,
          avg(c1) over main_s1_t1_0s_1d as main_c1_91,
          s1 as main_s1_92,
          d1 as main_d1_92,
          d2 as main_d2_92,
          d1 as main_d1_94,
          s2 as main_s2_96,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_s1_t1_0s_32d as main_s2_99,
          s1 as main_s1_102,
          s1 as main_s1_104,
          d2 as main_d2_104,
          d1 as main_d1_105,
          sum(c1) over main_s1_t1_0_10 as main_c1_106,
          s1 as main_s1_110,
          c1 as main_c1_113,
          d2 as main_d2_117,
          d2 as main_d2_118,
          min(c2) over main_d1_t1_0s_32d as main_c2_119,
          s1 as main_s1_121,
          s1 as main_s1_122,
          d1 as main_d1_122,
          s1 as main_s1_125,
          d1 as main_d1_126,
          max(c1) over main_d2_t1_0_10 as main_c1_130,
          min(c2) over main_s1_t1_0s_32d as main_c2_134,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s1_t1_0s_1d as main_d2_135,
          c2 as main_c2_139,
          d1 as main_d1_142,
          s2 as main_s2_143,
          d1 as main_d1_144,
          log(c1) as main_c1_145,
          sum(c1) over main_s2_t1_0_10 as main_c1_147,
          d1 as main_d1_149,
          d2 as main_d2_150,
          d1 as main_d1_151,
          sum(c1) over main_s1_t1_0s_32d as main_c1_152,
          max(c2) over main_d1_t1_0s_1d as main_c2_153,
          min(c2) over main_d2_t1_0_10 as main_c2_154,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d2_t1_0_100 as main_s1_156,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s1_t1_0_100 as main_d1_160,
          c2 as main_c2_161,
          c2 as main_c2_163,
          s2 as main_s2_168,
          d1 as main_d1_168,
          c1 as main_c1_169,
          avg(c2) over main_s2_t1_0_10 as main_c2_172,
          s1 as main_s1_175,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s1_t1_0s_1d as main_d1_176,
          s1 as main_s1_177,
          d1 as main_d1_177,
          d2 as main_d2_178,
          c2 as main_c2_179,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_s1_t1_0_10 as main_s2_180,
          s1 as main_s1_183,
          d2 as main_d2_183,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d1_t1_0s_1d as main_s1_185,
          s2 as main_s2_186,
          max(c1) over main_s1_t1_0s_1d as main_c1_190,
          s2 as main_s2_192,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d1_t1_0_100 as main_s2_193,
          max(c2) over main_d1_t1_0_10 as main_c2_195,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_d1_t1_0_100 as main_d2_197,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d2_t1_0_10 as main_s2_201,
          avg(c2) over main_s1_t1_0s_1d as main_c2_206,
          c1 as main_c1_209,
          d1 as main_d1_213,
          d2 as main_d2_213,
          c2 as main_c2_214,
          avg(c2) over main_s2_t1_0_100 as main_c2_215,
          c1 as main_c1_216,
          s2 as main_s2_217,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s1_t1_0s_32d as main_d2_218,
          c1 as main_c1_219,
          s2 as main_s2_220,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_d1_t1_0s_1d as main_d2_222,
          s1 as main_s1_223,
          s2 as main_s2_223,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s2_t1_0s_1d as main_d2_224,
          c1 as main_c1_227,
          c2 as main_c2_228,
          d1 as main_d1_229,
          d2 as main_d2_230,
          sum(c1) over main_d1_t1_0s_1d as main_c1_235,
          d1 as main_d1_237,
          c2 as main_c2_241,
          c2 as main_c2_242,
          d1 as main_d1_245,
          sum(c2) over main_d1_t1_0_10 as main_c2_248,
          s1 as main_s1_249,
          d1 as main_d1_249,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_s2_t1_0s_1d as main_s1_251,
          d2 as main_d2_252,
          s2 as main_s2_255,
          s2 as main_s2_256,
          d1 as main_d1_256,
          d2 as main_d2_256,
          c1 as main_c1_257,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d2_t1_0_10 as main_s1_259,
          d2 as main_d2_260,
          d2 as main_d2_261,
          min(c1) over main_d1_t1_0s_32d as main_c1_262,
          c1 as main_c1_263,
          s1 as main_s1_266,
          d1 as main_d1_266,
          s1 as main_s1_267,
          c2 as main_c2_268,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s1_t1_0_100 as main_d2_270,
          s2 as main_s2_272,
          d2 as main_d2_272,
          sum(c1) over main_d1_t1_0_10 as main_c1_273,
          d2 as main_d2_276,
          c1 as main_c1_277,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_s1_t1_0s_1d as main_s2_278,
          s2 as main_s2_279,
          c2 as main_c2_281,
          s2 as main_s2_282,
          sum(c1) over main_d2_t1_0_100 as main_c1_286,
          c2 as main_c2_288,
          s2 as main_s2_289,
          c2 as main_c2_290,
          s2 as main_s2_291,
          d1 as main_d1_297,
          d2 as main_d2_297,
          s2 as main_s2_298,
          sum(c2) over main_s1_t1_0s_32d as main_c2_299,
          c1 as main_c1_301,
          min(c1) over main_s1_t1_0s_32d as main_c1_303,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_d1_t1_0s_1d as main_d2_308,
          s1 as main_s1_309,
          d1 as main_d1_309,
          s2 as main_s2_312,
          d2 as main_d2_312,
          avg(c2) over main_d2_t1_0s_32d as main_c2_313,
          s2 as main_s2_316,
          d1 as main_d1_317,
          d2 as main_d2_317,
          avg(c1) over main_d2_t1_0_10 as main_c1_320,
          d2 as main_d2_322,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d2_t1_0s_1d as main_s2_323,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s1_t1_0s_32d as main_d2_325,
          s1 as main_s1_327,
          s2 as main_s2_327,
          d2 as main_d2_327,
          avg(c2) over main_s2_t1_0s_32d as main_c2_329,
          c1 as main_c1_334,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d2_t1_0s_1d as main_s1_335,
          d1 as main_d1_336,
          max(c2) over main_d1_t1_0_100 as main_c2_337,
          d2 as main_d2_338,
          c2 as main_c2_339,
          max(c1) over main_s1_t1_0_10 as main_c1_344,
          s1 as main_s1_345,
          avg(c1) over main_d1_t1_0_10 as main_c1_346,
          d1 as main_d1_348,
          d2 as main_d2_348,
          c1 as main_c1_350,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s1_t1_0_10 as main_d1_351,
          d1 as main_d1_353,
          c2 as main_c2_354,
          s1 as main_s1_355,
          s2 as main_s2_360,
          d1 as main_d1_360,
          s2 as main_s2_361,
          sum(c1) over main_d2_t1_0_10 as main_c1_362,
          c1 as main_c1_363,
          s1 as main_s1_365,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d2_t1_0_10 as main_s2_366,
          s2 as main_s2_368,
          dayofweek(timestamp(t1)) as main_t1_370,
          d2 as main_d2_372,
          d1 as main_d1_374,
          d2 as main_d2_374,
          avg(c1) over main_d1_t1_0s_1d as main_c1_378,
          c1 as main_c1_379,
          c1 as main_c1_381,
          d1 as main_d1_383,
          d2 as main_d2_384,
          s1 as main_s1_389,
          c1 as main_c1_390,
          c1 as main_c1_394,
          sum(c2) over main_s2_t1_0_10 as main_c2_398,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s2_t1_0s_1d as main_d1_401,
          min(c2) over main_d1_t1_0s_1d as main_c2_402,
          sum(c1) over main_s1_t1_0_100 as main_c1_405,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d2_t1_0s_1d as main_s1_406,
          c1 as main_c1_407,
          c2 as main_c2_408,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s2_t1_0s_1d as main_d2_410,
          min(c2) over main_s2_t1_0_100 as main_c2_411,
          s2 as main_s2_412,
          sum(c1) over main_s2_t1_0s_1d as main_c1_415,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_s1_t1_0s_1d as main_s2_418,
          s2 as main_s2_419,
          d1 as main_d1_419,
          s2 as main_s2_420,
          d1 as main_d1_420,
          s1 as main_s1_421,
          s2 as main_s2_421,
          max(c1) over main_d2_t1_0s_32d as main_c1_426,
          s1 as main_s1_427,
          d1 as main_d1_427,
          d1 as main_d1_430,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d2_t1_0_100 as main_s2_431,
          d1 as main_d1_433,
          c1 as main_c1_434,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d1_t1_0s_1d as main_s2_435,
          c1 as main_c1_437,
          max(c1) over main_d1_t1_0_10 as main_c1_440,
          c1 as main_c1_442,
          c1 as main_c1_444,
          d1 as main_d1_446,
          d2 as main_d2_446,
          sum(c1) over main_d1_t1_0_100 as main_c1_447,
          s1 as main_s1_450,
          d2 as main_d2_450,
          d2 as main_d2_451,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s1_t1_0_10 as main_d2_453,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d1_t1_0s_32d as main_s2_454,
          s1 as main_s1_455,
          s2 as main_s2_455,
          c2 as main_c2_458,
          min(c1) over main_s1_t1_0_10 as main_c1_459,
          c2 as main_c2_460,
          avg(c1) over main_s1_t1_0_100 as main_c1_463,
          d1 as main_d1_465,
          sum(c1) over main_d2_t1_0s_1d as main_c1_467,
          c2 as main_c2_470,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_d2_t1_0s_1d as main_d1_471,
          d2 as main_d2_476,
          c2 as main_c2_477,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d1_t1_0s_32d as main_s1_478,
          c1 as main_c1_480,
          s2 as main_s2_481,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_s1_t1_0_100 as main_s2_482,
          s2 as main_s2_487,
          d2 as main_d2_487,
          sum(c2) over main_s2_t1_0s_32d as main_c2_488,
          d1 as main_d1_491,
          c1 as main_c1_493,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_s2_t1_0s_1d as main_s1_494,
          c1 as main_c1_496,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s1_t1_0_100 as main_d2_497,
          max(c1) over main_s2_t1_0s_1d as main_c1_498,
          avg(c2) over main_d2_t1_0_10 as main_c2_499,
          max(c2) over main_s1_t1_0_100 as main_c2_502,
          c1 as main_c1_503,
          max(c2) over main_d2_t1_0s_32d as main_c2_504,
          s1 as main_s1_506,
          d1 as main_d1_506,
          avg(c2) over main_s1_t1_0_100 as main_c2_509,
          s1 as main_s1_510,
          s1 as main_s1_512,
          d1 as main_d1_512,
          c2 as main_c2_513,
          d1 as main_d1_515,
          d2 as main_d2_515,
          d2 as main_d2_516,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d2_t1_0s_32d as main_s2_519,
          c2 as main_c2_521,
          d1 as main_d1_524,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_s2_t1_0s_32d as main_s1_525,
          s2 as main_s2_526,
          d2 as main_d2_526,
          max(c1) over main_s1_t1_0s_32d as main_c1_528,
          s1 as main_s1_533,
          c2 as main_c2_534,
          c2 as main_c2_544,
          c1 as main_c1_545,
          s2 as main_s2_546,
          d2 as main_d2_547,
          max(c1) over main_d1_t1_0s_32d as main_c1_548,
          c1 as main_c1_549,
          log(c2) as main_c2_554,
          min(c2) over main_s2_t1_0s_32d as main_c2_558,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d1_t1_0_100 as main_s2_560,
          avg(c1) over main_d2_t1_0s_32d as main_c1_564,
          c2 as main_c2_565,
          c2 as main_c2_569,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_s1_t1_0_100 as main_s2_570,
          d1 as main_d1_571,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_d2_t1_0_100 as main_d1_572,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s2_t1_0_100 as main_d2_574,
          case when 1 < dayofweek(timestamp(t1)) and dayofweek(timestamp(t1)) < 7 then 1 else 0 end as main_t1_575,
          s2 as main_s2_576,
          d1 as main_d1_576,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d2_t1_0_100 as main_s1_578,
          min(c1) over main_s1_t1_0_100 as main_c1_579,
          d1 as main_d1_581,
          max(c2) over main_s1_t1_0_10 as main_c2_582,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d1_t1_0_100 as main_s1_583,
          d2 as main_d2_588,
          c1 as main_c1_590,
          dayofweek(timestamp(t2)) as main_t2_591,
          c2 as main_c2_592,
          d2 as main_d2_594,
          avg(c1) over main_s1_t1_0_10 as main_c1_595,
          sum(c1) over main_s1_t1_0s_1d as main_c1_596,
          s1 as main_s1_598,
          avg(c1) over main_s2_t1_0s_32d as main_c1_599,
          s1 as main_s1_602,
          avg(c1) over main_d1_t1_0_100 as main_c1_607,
          d2 as main_d2_608,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_s2_t1_0_10 as main_s1_609,
          min(c2) over main_d1_t1_0_100 as main_c2_610,
          s2 as main_s2_613,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d1_t1_0s_1d as main_s2_615,
          s2 as main_s2_617,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s2_t1_0s_1d as main_d1_618,
          sum(c2) over main_s2_t1_0_100 as main_c2_619,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s1_t1_0_10 as main_d1_620,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_d1_t1_0_100 as main_d2_623,
          s2 as main_s2_625,
          s1 as main_s1_631,
          c1 as main_c1_638,
          s1 as main_s1_643,
          c1 as main_c1_650,
          s2 as main_s2_651,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s1_t1_0_10 as main_d2_653,
          c1 as main_c1_658,
          s1 as main_s1_660,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s2_t1_0_10 as main_d1_662,
          c1 as main_c1_663,
          s1 as main_s1_666,
          d2 as main_d2_667,
          s1 as main_s1_668,
          d2 as main_d2_668,
          c2 as main_c2_669,
          c2 as main_c2_670,
          d2 as main_d2_672,
          sum(c1) over main_d2_t1_0s_32d as main_c1_675,
          avg(c1) over main_d2_t1_0_100 as main_c1_677,
          s2 as main_s2_679,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d1_t1_0_10 as main_s2_680,
          s2 as main_s2_681,
          s1 as main_s1_683,
          d1 as main_d1_684,
          min(c2) over main_s1_t1_0_10 as main_c2_686,
          s2 as main_s2_687,
          d1 as main_d1_687,
          s1 as main_s1_688,
          d2 as main_d2_695,
          d2 as main_d2_696,
          min(c1) over main_s2_t1_0s_32d as main_c1_699,
          avg(c2) over main_d2_t1_0_100 as main_c2_700,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_d1_t1_0s_32d as main_d2_701,
          d1 as main_d1_704,
          min(c1) over main_d1_t1_0_100 as main_c1_705,
          s1 as main_s1_707,
          min(c2) over main_d2_t1_0s_32d as main_c2_709,
          c1 as main_c1_710,
          c2 as main_c2_712,
          d1 as main_d1_713,
          c2 as main_c2_721,
          d1 as main_d1_722,
          d2 as main_d2_722,
          d1 as main_d1_723,
          d2 as main_d2_723,
          identity(case when at(s2, 0) != null then distinct_count(s2) else null end) over main_d1_t1_0s_32d as main_s2_726,
          d1 as main_d1_727,
          min(c2) over main_d2_t1_0s_1d as main_c2_731,
          c1 as main_c1_732,
          max(c2) over main_s2_t1_0s_1d as main_c2_733,
          d1 as main_d1_735,
          d2 as main_d2_737,
          s2 as main_s2_740,
          c2 as main_c2_743,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d1_t1_0s_32d as main_s1_745,
          c1 as main_c1_746,
          c1 as main_c1_747,
          hour(timestamp(t2)) as main_t2_751,
          sum(c2) over main_s1_t1_0s_1d as main_c2_752,
          avg(c1) over main_s2_t1_0s_1d as main_c1_753,
          s2 as main_s2_754,
          d1 as main_d1_755,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s1_t1_0s_1d as main_d1_756,
          s1 as main_s1_759,
          c1 as main_c1_760,
          d1 as main_d1_761,
          d1 as main_d1_763,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_d2_t1_0_10 as main_d1_764,
          c2 as main_c2_765,
          c1 as main_c1_766,
          d1 as main_d1_767,
          s2 as main_s2_769,
          case when 1 < dayofweek(timestamp(t2)) and dayofweek(timestamp(t2)) < 7 then 1 else 0 end as main_t2_770,
          s1 as main_s1_772,
          c2 as main_c2_774,
          s2 as main_s2_775,
          d2 as main_d2_775,
          max(c1) over main_s2_t1_0_10 as main_c1_776,
          c2 as main_c2_777,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_d1_t1_0_10 as main_d2_778,
          c2 as main_c2_779,
          s1 as main_s1_780,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_s2_t1_0_100 as main_s1_781,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d2_t1_0_10 as main_s1_782,
          min(c2) over main_d1_t1_0_10 as main_c2_784,
          s2 as main_s2_785,
          s1 as main_s1_786,
          s2 as main_s2_786,
          avg(c1) over main_d1_t1_0s_32d as main_c1_787,
          max(c1) over main_s2_t1_0_100 as main_c1_788,
          c2 as main_c2_790,
          c1 as main_c1_793,
          sum(c2) over main_s2_t1_0s_1d as main_c2_795,
          sum(c2) over main_s1_t1_0_100 as main_c2_796,
          s1 as main_s1_799,
          s1 as main_s1_800,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_d2_t1_0s_1d as main_d1_803,
          c2 as main_c2_808,
          c1 as main_c1_809,
          sum(c2) over main_d2_t1_0s_1d as main_c2_810,
          max(c2) over main_s1_t1_0s_1d as main_c2_815,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_s2_t1_0_10 as main_s1_823,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d2_t1_0s_32d as main_s1_824,
          d1 as main_d1_825,
          c2 as main_c2_827,
          min(c2) over main_s2_t1_0s_1d as main_c2_828,
          sum(c2) over main_s1_t1_0_10 as main_c2_830,
          s1 as main_s1_837,
          d2 as main_d2_837,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s2_t1_0s_32d as main_d2_838,
          d1 as main_d1_839,
          min(c2) over main_d2_t1_0_100 as main_c2_850,
          sum(c2) over main_d2_t1_0_100 as main_c2_851,
          s2 as main_s2_852,
          s1 as main_s1_854,
          s2 as main_s2_854,
          c2 as main_c2_857,
          d2 as main_d2_858,
          min(c1) over main_s2_t1_0s_1d as main_c1_859,
          max(c1) over main_d2_t1_0_100 as main_c1_860,
          max(c1) over main_s1_t1_0_100 as main_c1_861,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s1_t1_0s_32d as main_d1_862,
          s2 as main_s2_864,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s2_t1_0s_32d as main_d1_865,
          d2 as main_d2_868,
          c1 as main_c1_869,
          s1 as main_s1_870,
          s2 as main_s2_870,
          s2 as main_s2_877,
          c1 as main_c1_882,
          d2 as main_d2_883,
          d1 as main_d1_884,
          d2 as main_d2_885,
          min(c1) over main_d2_t1_0s_1d as main_c1_886,
          avg(c2) over main_d1_t1_0_10 as main_c2_891,
          s2 as main_s2_892,
          max(c1) over main_d2_t1_0s_1d as main_c1_893,
          c1 as main_c1_895,
          c2 as main_c2_895,
          s1 as main_s1_896,
          s2 as main_s2_896,
          c2 as main_c2_897,
          max(c1) over main_s2_t1_0s_32d as main_c1_899,
          c1 as main_c1_900,
          c2 as main_c2_902,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s2_t1_0_10 as main_d1_903,
          s1 as main_s1_905,
          d2 as main_d2_905,
          c2 as main_c2_906,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s1_t1_0_100 as main_d1_911,
          s2 as main_s2_913,
          c1 as main_c1_915,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_s2_t1_0_10 as main_d2_916,
          s2 as main_s2_918,
          c2 as main_c2_919,
          sum(c1) over main_s2_t1_0_100 as main_c1_921,
          s2 as main_s2_922,
          d1 as main_d1_922,
          min(c1) over main_s1_t1_0s_1d as main_c1_923,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d1_t1_0_10 as main_s2_924,
          s2 as main_s2_925,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_d2_t1_0s_32d as main_d1_928,
          min(c1) over main_d2_t1_0_10 as main_c1_930,
          d1 as main_d1_932,
          s1 as main_s1_934,
          max(c2) over main_d2_t1_0s_1d as main_c2_936,
          s2 as main_s2_938,
          c2 as main_c2_942,
          c2 as main_c2_944,
          s1 as main_s1_946,
          s2 as main_s2_946,
          d2 as main_d2_948,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_d1_t1_0s_32d as main_d2_950,
          d2 as main_d2_952,
          s2 as main_s2_954,
          c2 as main_c2_955,
          max(c1) over main_d1_t1_0_100 as main_c1_956,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d2_t1_0s_32d as main_s1_958,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_d2_t1_0_100 as main_d1_960,
          s1 as main_s1_961,
          d1 as main_d1_961,
          c2 as main_c2_962,
          s2 as main_s2_963,
          d2 as main_d2_963,
          max(c2) over main_s2_t1_0_100 as main_c2_964,
          max(c2) over main_s2_t1_0_10 as main_c2_965,
          min(c1) over main_d2_t1_0s_32d as main_c1_966,
          c1 as main_c1_968,
          sum(c2) over main_d1_t1_0s_32d as main_c2_970,
          c1 as main_c1_974,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_s2_t1_0s_32d as main_s1_975,
          c1 as main_c1_983,
          c2 as main_c2_983,
          s2 as main_s2_987,
          d2 as main_d2_987,
          s1 as main_s1_988,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_d2_t1_0s_32d as main_d1_994,
          avg(c2) over main_d1_t1_0s_32d as main_c2_998,
          s1 as main_s1_999,
          s1 as main_s1_1001,
          c2 as main_c2_1002,
          c1 as main_c1_1004,
          s2 as main_s2_1005,
          min(c2) over main_s2_t1_0_10 as main_c2_1006,
          s1 as main_s1_1008,
          d2 as main_d2_1008,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s2_t1_0s_32d as main_d1_1009,
          c2 as main_c2_1011,
          identity(case when at(d1, 0) != null then distinct_count(d1) else null end) over main_s2_t1_0_100 as main_d1_1013,
          s1 as main_s1_1014,
          d1 as main_d1_1014,
          s2 as main_s2_1015,
          s1 as main_s1_1016,
          min(c2) over main_s1_t1_0_100 as main_c2_1018,
          d1 as main_d1_1024,
          d2 as main_d2_1030,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d2_t1_0s_1d as main_s2_1032,
          identity(case when at(d2, 0) != null then count(d2) else null end) over main_d1_t1_0_10 as main_d2_1033,
          c2 as main_c2_1034,
          c2 as main_c2_1036,
          s1 as main_s1_1037,
          c2 as main_c2_1039,
          s2 as main_s2_1041,
          d1 as main_d1_1041,
          avg(c2) over main_s1_t1_0_10 as main_c2_1047,
          d1 as main_d1_1049,
          d2 as main_d2_1050,
          s1 as main_s1_1051,
          c1 as main_c1_1052,
          min(c1) over main_d2_t1_0_100 as main_c1_1057,
          hour(timestamp(t1)) as main_t1_1060,
          min(c1) over main_s2_t1_0_10 as main_c1_1061,
          d1 as main_d1_1071,
          s2 as main_s2_1073,
          d1 as main_d1_1073,
          c1 as main_c1_1076,
          avg(c2) over main_d2_t1_0s_1d as main_c2_1077,
          c1 as main_c1_1079,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d2_t1_0_100 as main_s2_1080,
          avg(c2) over main_d1_t1_0_100 as main_c2_1084,
          s2 as main_s2_1085,
          c1 as main_c1_1086,
          c2 as main_c2_1087,
          s1 as main_s1_1089,
          d2 as main_d2_1089,
          c1 as main_c1_1091,
          avg(c2) over main_s1_t1_0s_32d as main_c2_1092,
          d2 as main_d2_1094,
          d1 as main_d1_1095,
          s2 as main_s2_1097,
          c1 as main_c1_1100,
          min(c1) over main_d1_t1_0s_1d as main_c1_1101,
          s1 as main_s1_1102,
          d2 as main_d2_1104,
          s1 as main_s1_1105,
          s2 as main_s2_1105,
          s2 as main_s2_1106,
          c2 as main_c2_1108,
          c1 as main_c1_1109,
          d2 as main_d2_1110,
          c1 as main_c1_1113,
          s1 as main_s1_1114,
          c1 as main_c1_1115,
          s2 as main_s2_1116,
          s1 as main_s1_1117,
          avg(c1) over main_s2_t1_0_100 as main_c1_1118,
          min(c2) over main_s1_t1_0s_1d as main_c2_1120,
          c1 as main_c1_1122,
          s2 as main_s2_1123,
          d2 as main_d2_1123,
          d2 as main_d2_1127,
          d1 as main_d1_1129,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d1_t1_0s_1d as main_s1_1130,
          s1 as main_s1_1131,
          min(c1) over main_d1_t1_0_10 as main_c1_1136,
          s1 as main_s1_1137,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_s2_t1_0_100 as main_d1_1140,
          avg(c1) over main_s1_t1_0s_32d as main_c1_1145,
          avg(c2) over main_d1_t1_0s_1d as main_c2_1146,
          sum(c1) over main_d1_t1_0s_32d as main_c1_1148,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d1_t1_0_10 as main_s1_1149,
          identity(case when at(s2, 0) != null then count(s2) else null end) over main_d2_t1_0s_32d as main_s2_1151,
          c2 as main_c2_1152,
          s2 as main_s2_1153,
          c1 as main_c1_1154,
          s2 as main_s2_1157,
          c2 as main_c2_1160,
          s1 as main_s1_1161,
          avg(c2) over main_s2_t1_0s_1d as main_c2_1163,
          sum(c1) over main_s2_t1_0s_32d as main_c1_1165,
          c1 as main_c1_1166,
          c2 as main_c2_1166,
          c2 as main_c2_1172,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s2_t1_0s_32d as main_d2_1173,
          avg(c1) over main_d2_t1_0s_1d as main_c1_1178,
          d2 as main_d2_1181,
          c1 as main_c1_1183,
          c2 as main_c2_1183,
          s1 as main_s1_1186,
          s1 as main_s1_1187,
          d1 as main_d1_1190,
          s1 as main_s1_1192,
          c2 as main_c2_1194,
          d2 as main_d2_1196,
          sum(c2) over main_d2_t1_0_10 as main_c2_1197,
          min(c1) over main_s2_t1_0_100 as main_c1_1200,
          avg(c1) over main_s2_t1_0_10 as main_c1_1202,
          d1 as main_d1_1204,
          c2 as main_c2_1205,
          max(c1) over main_d1_t1_0s_1d as main_c1_1206,
          c2 as main_c2_1208,
          d2 as main_d2_1212,
          d2 as main_d2_1214,
          identity(case when at(d1, 0) != null then count(d1) else null end) over main_d2_t1_0_10 as main_d1_1217,
          identity(case when at(d2, 0) != null then distinct_count(d2) else null end) over main_s2_t1_0_10 as main_d2_1218,
          c2 as main_c2_1219,
          max(c2) over main_d2_t1_0_10 as main_c2_1220,
          d1 as main_d1_1221,
          max(c2) over main_s1_t1_0s_32d as main_c2_1226,
          s2 as main_s2_1229,
          d2 as main_d2_1229,
          s2 as main_s2_1230,
          d2 as main_d2_1230,
          s1 as main_s1_1234,
          d2 as main_d2_1234,
          d1 as main_d1_1235,
          d1 as main_d1_1236,
          sum(c2) over main_d1_t1_0s_1d as main_c2_1237,
          d2 as main_d2_1238,
          d1 as main_d1_1239,
          c1 as main_c1_1241,
          s1 as main_s1_1243,
          c2 as main_c2_1244,
          identity(case when at(s1, 0) != null then count(s1) else null end) over main_d1_t1_0_100 as main_s1_1246,
          d2 as main_d2_1247,
          identity(case when at(s1, 0) != null then distinct_count(s1) else null end) over main_d1_t1_0_10 as main_s1_1248,
          c2 as main_c2_1253,
          sum(c2) over main_d2_t1_0s_32d as main_c2_1255,
          d1 as main_d1_1256,
          d2 as main_d2_1256,
          s1 as main_s1_1257
      from
          main
          window main_s2_t1_0_100 as ( partition by s2 order by t1 rows_range between 100 preceding and 0 preceding),
          main_s1_t1_0s_1d as ( partition by s1 order by t1 rows_range between 1d preceding and 0s preceding),
          main_s1_t1_0s_32d as ( partition by s1 order by t1 rows_range between 32d preceding and 0s preceding),
          main_s2_t1_0s_32d as ( partition by s2 order by t1 rows_range between 32d preceding and 0s preceding),
          main_d1_t1_0_100 as ( partition by d1 order by t1 rows_range between 100 preceding and 0 preceding),
          main_d1_t1_0s_32d as ( partition by d1 order by t1 rows_range between 32d preceding and 0s preceding),
          main_d2_t1_0_100 as ( partition by d2 order by t1 rows_range between 100 preceding and 0 preceding),
          main_s1_t1_0_10 as ( partition by s1 order by t1 rows_range between 10 preceding and 0 preceding),
          main_d2_t1_0_10 as ( partition by d2 order by t1 rows_range between 10 preceding and 0 preceding),
          main_s2_t1_0_10 as ( partition by s2 order by t1 rows_range between 10 preceding and 0 preceding),
          main_d1_t1_0s_1d as ( partition by d1 order by t1 rows_range between 1d preceding and 0s preceding),
          main_s1_t1_0_100 as ( partition by s1 order by t1 rows_range between 100 preceding and 0 preceding),
          main_d1_t1_0_10 as ( partition by d1 order by t1 rows_range between 10 preceding and 0 preceding),
          main_s2_t1_0s_1d as ( partition by s2 order by t1 rows_range between 1d preceding and 0s preceding),
          main_d2_t1_0s_32d as ( partition by d2 order by t1 rows_range between 32d preceding and 0s preceding),
          main_d2_t1_0s_1d as ( partition by d2 order by t1 rows_range between 1d preceding and 0s preceding);
    inputs:
      - name: main
        schema: label:int,s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1,index2:s1:t1,index3:d1:t1,index4:d2:t1
        data: |
          1, 1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_1
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s2:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_2
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
      - name: table_3
        schema: s1:string,s2:string,t1:timestamp,t2:date,d1:string,d2:string,c1:int,c2:bigint,ai:string,kn:string,ks:string
        index: index1:s1:t1
        data: |
          1, 2, 1600946381104, 2019-07-18, xx, xx, 1,2,3x,4x,kx
    expect:
      schema: col2:int16, col5:int64, w1_col1_sum:int32, w1_col3_sum:float, w1_col4_sum:double, w1_col2_sum:int16, w1_col5_sum:int64, w1_col1_cnt:int64, col1:int32, col6:string
      order: col1
      data: |
        5, 2, 2, 2.1, 21.1, 10, 3, 2, 1, 1
        5, 4, 5, 5.3, 53.3, 15, 9, 3, 2, 22
        55, 2, 6, 6.3, 63.3, 110, 3, 2, 3, 333
        55, 4, 11, 11.7, 117.7, 165, 9, 3, 4, 4444
        55,6, 14, 14.9, 149.9, 165, 15, 3, 5, aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa