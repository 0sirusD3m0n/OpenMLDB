cases:
  - id: 0
    desc: SELECT Day(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_ts, std_date, day(std_date) as mday from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1590115420001, 2020-05-20
          2, 1590115421001, 2020-05-21
          3, 1590115422001, 2020-05-22

    expect:
      schema: id:int32, std_ts:timestamp, std_date:date, mday:int32
      order: id
      data: |
        1, 1590115420001, 2020-05-20, 20
        2, 1590115421001, 2020-05-21, 21
        3, 1590115422001, 2020-05-22, 22
  - id: 1
    desc: SELECT Month(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_ts, std_date, month(std_date) as `month` from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1590115420001, 2020-05-20
          2, 1590115421001, 2020-06-21
          3, 1590115422001, 2020-07-22

    expect:
      schema: id:int32, std_ts:timestamp, std_date:date, month:int32
      order: id
      data: |
        1, 1590115420001, 2020-05-20, 05
        2, 1590115421001, 2020-06-21, 06
        3, 1590115422001, 2020-07-22, 07
  - id: 2
    desc: SELECT Year(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_ts, std_date, year(std_date) as `year` from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1590115420001, 2020-05-20
          2, 1590115421001, 1900-06-21

    expect:
      schema: id:int32, std_ts:timestamp, std_date:date, year:int32
      order: id
      data: |
        1, 1590115420001, 2020-05-20, 2020
        2, 1590115421001, 1900-06-21, 1900
  - id: 3
    desc: SELECT Weekday(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_ts, std_date, dayofweek(std_date) as wday from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1590115420001, 2020-05-20
          2, 1590115421001, 1900-06-21

    expect:
      schema: id:int32, std_ts:timestamp, std_date:date, wday:int32
      order: id
      data: |
        1, 1590115420001, 2020-05-20, 4
        2, 1590115421001, 1900-06-21, 5
  - id: 4
    desc: SELECT Week(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_date, week(std_date) as `week` from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1, 2020-05-22
          2, 2, 2020-05-23
          3, 3, 2020-05-24
          4, 4, 2020-05-25

    expect:
      schema: id:int32, std_date:date, week:int32
      order: id
      data: |
        1, 2020-05-22, 21
        2, 2020-05-23, 21
        3, 2020-05-24, 21
        4, 2020-05-25, 22

  - id: 5
    desc: SELECT Day, Month, Year, Weekday, Week, Hour, Minute, Second Of Timestamp
    mode: request
    db: db1
    sql: |
      select col1 as id, std_ts,
      day(std_ts) as mday, month(std_ts) as `month`, year(std_ts) as `year`,
      dayofweek(std_ts) as wday, weekofyear(std_ts) as yweek,
      hour(std_ts) as `hour`, minute(std_ts) as `minute`, second(std_ts) as `second`
      from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp
        index: index2:col1:std_ts
        data: |
          1, 1590115420000

    expect:
      schema: |
        id:int32, std_ts:timestamp, mday:int32, month:int32, year:int32, wday:int32, yweek:int32
        hour:int32, minute:int32, second:int32
      order: id
      data: |
        1, 1590115420000, 22, 5, 2020, 6, 21, 10, 43, 40
  - id: 6
    desc: SELECT DayOfMonth(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_ts, std_date, dayofmonth(std_date) as mday from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1590115420001, 2020-05-20
          2, 1590115421001, 2020-05-21
          3, 1590115422001, 2020-05-22

    output:
      schema: id:int32, std_ts:timestamp, std_date:date, mday:int32
      order: id
      data: |
        1, 1590115420001, 2020-05-20, 20
        2, 1590115421001, 2020-05-21, 21
        3, 1590115422001, 2020-05-22, 22
  - id: 7
    desc: SELECT WeekOfYear(date列)
    mode: request
    db: db1
    sql: select col1 as id, std_date, weekofyear(std_date) as yweek from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1, 2020-05-22
          2, 2, 2020-05-23
          3, 3, 2020-05-24
          4, 4, 2020-05-25

    output:
      schema: id:int32, std_date:date, yweek:int32
      order: id
      data: |
        1, 2020-05-22, 21
        2, 2020-05-23, 21
        3, 2020-05-24, 21
        4, 2020-05-25, 22
  - id: 8
    desc: SELECT day(null)
    tags: ["TODO", "null还不支持"]
    mode: request
    db: db1
    sql: select col1 as id, std_date, day(std_date) as m from t1;
    inputs:
      - name: t1
        schema: col1:int32, std_ts:timestamp, std_date:date
        index: index2:col1:std_ts
        data: |
          1, 1, 2020-05-22
          2, 2, 2020-05-23
          3, 3, 2020-05-24
          4, 4, NULL

    output:
      schema: id:int32, std_date:date, m:int32
      order: id
      data: |
        1, 2020-05-22, 22
        2, 2020-05-23, 23
        3, 2020-05-24, 24
        4, NULL, NULL