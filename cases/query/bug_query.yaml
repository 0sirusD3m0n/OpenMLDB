db: test_zw
cases:
  - id: 0
    desc: stringä¸ºpartition by
    mode: offline-unsupport
    inputs:
      - name: t1
        columns: ["id int", "c1 string","c3 int","c4 bigint","c5 float","c6 double","c7 timestamp","c8 date"]
        indexs: ["index1:c1:c7"]
        rows:
          - [1, "aa",20,30,1.1,2.1,1590738990000,"2020-05-01"]
          - [2, "aa",21,31,1.2,2.2,1590738991000,"2020-05-02"]
          - [3, "aa",22,32,1.3,2.3,1590738992000,"2020-05-03"]
          - [4, "aa",23,33,1.4,2.4,1590738993000,"2020-05-04"]
          - [5, "bb",24,34,1.5,2.5,1590738994000,"2020-05-05"]
    sql: |
      SELECT id, c1, c3, sum(c4) OVER w1 as w1_c4_sum FROM t1 WINDOW w1 AS (PARTITION BY {0}.c1 ORDER BY {0}.c7 ROWS_RANGE BETWEEN 2s PRECEDING AND CURRENT ROW);
    expect:
      order: id
      columns: ["id int", "c1 string","c3 int","w1_c4_sum bigint"]
      rows:
        - [1, "aa",20,30]
        - [2, "aa",21,61]
        - [3, "aa",22,93]
        - [4, "aa",23,96]
        - [5, "bb",24,34]
