db: test_zw
cases:
  - id: 2
    desc: 布尔表达式
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
    sql: select c1,c2=1,c3==3,c2!=1,c3>3,c2>=2,c3<=3,c2<2 from {0};
    expect:
      columns: ["c1 string", "c2 = 1 bool", "c3 = 3 bool", "c2 != 1 bool", "c3 > 3 bool", "c2 >= 2 bool", "c3 <= 3 bool", "c2 < 2 bool"]
      rows:
        - ["aa",false,true,true,false,true,true,false]
  - id: 3
    desc: 逻辑表达式
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
    sql: select c1,c2=1 and c3==3,c2=1 && c3==3,c2=1 or c3==3,c2=1 || c3==3,!(c2=1) from {0};
    expect:
      columns: ["c1 string","c2 = 1 AND c3 = 3 bool" ,"c2 = 1 AND c3 = 3 bool","c2 = 1 OR c3 = 3 bool","c2 = 1 OR c3 = 3 bool","NOT (c2 = 1) bool"]
      rows:
        - ["aa",false,false,true,true,true]

  - id: 7
    desc: 布尔表达式-字符类型
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
    sql: select c1='aa' as f1 from {0};
    expect:
      columns: ["f1 bool"]
      rows:
        - [true]
  - id: 8
    desc: 布尔表达式-日期类型
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp","c5 date"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000,"2020-05-01"]
    sql: select c5='2020-05-01' as f1, c5 > '2020-04-02' as f2 , concat(c5, "") as c5_str from {0};
    expect:
      columns: ["f1 bool", "f2 bool", "c5_str string"]
      rows:
        - [true, true, "2020-05-01"]
  - id: 9
    desc: 逻辑表达式不使用布尔表达式
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp","c5 date"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000,"2020-05-01"]
    sql: select c2=2 and (c2-1) as f1 from {0};
    expect:
      columns: ["f1 bool"]
      rows:
        - [true]
  - id: 10
    desc: 逻辑表达式不使用布尔表达式!
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp","c5 date"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000,"2020-05-01"]
    sql: select !c2 as not_c2 from {0};
    expect:
      columns: ["not_c2 bool"]
      rows:
        - [false]
  - id: 11
    desc: 逻辑表达式不使用布尔表达式-常量
    inputs:
      - columns: ["c1 string","c2 int","c3 bigint","c4 timestamp","c5 date"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000,"2020-05-01"]
    sql: select c2==2 and false as flag1,!true as flag2 from {0};
    expect:
      columns: ["flag1 bool", "flag2 bool"]
      rows:
        - [false,false]


  - id: 21-1
    desc: column name prefix with _
    mode: offline-unsupport
    tags: ["@chendihao, @baoxinqi, support simple project node with column cast"]
    inputs:
      - columns: ["_c1 int", "_c2 string", "_c5 bigint"]
        indexs: ["index1:_c1:_c5"]
        rows:
          - [1, "2020-05-22 10:43:40", 1]
    sql: |
      select _c1, bigint(_c2) DIV 1000 as _c2_sec from (select _c1, timestamp(_c2) as _c2 from {0});
    expect:
      columns: ["_c1 int", "_c2_sec bigint"]
      rows:
        - [1, 1590115420]
