db: test_zw
debugs: []
cases:
  -
    id: 1
    desc: 正常拼接
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["cc",41,51,1590738991000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["cc",41,151,1590738992000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c3 on {0}.c1={1}.c1;
    expect:
      order: c1
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,131,1590738990000]
        - ["cc",41,151,1590738992000]
  -
    id: 2
    desc: 右表没有匹配
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["cc",41,51,1590738991000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["dd",41,151,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c3 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,131,1590738990000]
        - ["cc",41,null,null]
  -
    id: 3
    desc: 右表匹配了多条-bigint
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c3 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,131,1590738990000]
  -
    id: 4
    desc: 没有使用order by
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} on {0}.c1={1}.c1;
    expect:
      success: false
  -
    id: 5
    desc: orderby-timestamp
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738992000]
          - ["bb",41,141,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,121,1590738992000]
  -
    id: 6
    desc: orderby-int
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738991000]
          - ["bb",31,141,1590738992000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c2 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,121,1590738991000]
  -
    id: 7
    desc: orderby-float
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.3,1590738990000,"2020-05-03","ab"]
          - ["bb",2.5,3.6,1590738991000,"2020-05-04","bc"]
          - ["bb",2.4,3.1,1590738992000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c2 on {0}.c1={1}.c1;
    expect:
      success: false
  -
    id: 8
    desc: orderby-double
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.3,1590738990000,"2020-05-03","ab"]
          - ["bb",2.5,3.6,1590738991000,"2020-05-04","bc"]
          - ["bb",2.4,3.1,1590738992000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c3 on {0}.c1={1}.c1;
    expect:
      success: false
  -
    id: 9
    desc: orderby-date
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.3,1590738990000,"2020-05-03","ab"]
          - ["bb",2.5,3.6,1590738991000,"2020-05-04","bc"]
          - ["bb",2.4,3.1,1590738992000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c5 on {0}.c1={1}.c1;
    expect:
      success: false
  -
    id: 10
    desc: orderby-string
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.3,1590738990000,"2020-05-03","ab"]
          - ["bb",2.5,3.6,1590738991000,"2020-05-04","bc"]
          - ["bb",2.4,3.1,1590738992000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c6 on {0}.c1={1}.c1;
    expect:
      success: false
  -
    id: 11
    desc: 拼接条件-bigint
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c3:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c3:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",41,31,1590738992000]
          - ["bb",41,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3={1}.c3;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 12
    desc: 拼接条件-int
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",21,31,1590738992000]
          - ["bb",21,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c2={1}.c2;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 13
    desc: 拼接条件-float
    inputs:
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02","aa"]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-03","ab"]
          - ["bb",2.2,3.2,1590738992000,"2020-05-04","bc"]
          - ["bb",2.2,3.2,1590738991000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c2={1}.c2;
    expect:
      columns : ["c1 string","c2 float","c3 double","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2.1,3.1,1590738989000]
        - ["bb",2.2,3.2,1590738992000]
  -
    id: 13-2
    desc: 拼接条件-double
    inputs:
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02","aa"]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-03","ab"]
          - ["bb",2.2,3.2,1590738992000,"2020-05-04","bc"]
          - ["bb",2.2,3.2,1590738991000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3={1}.c3;
    expect:
      columns : ["c1 string","c2 float","c3 double","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2.1,3.1,1590738989000]
        - ["bb",2.2,3.2,1590738992000]
  -
    id: 14
    desc: 拼接条件-date
    inputs:
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c5:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02","aa"]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 string"]
        indexs: ["index1:c5:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01","aa"]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02","ab"]
          - ["bb",2.2,3.2,1590738992000,"2020-05-02","bc"]
          - ["bb",2.2,3.2,1590738991000,"2020-05-02","bb"]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c5={1}.c5;
    expect:
      columns : ["c1 string","c2 float","c3 double","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2.1,3.1,1590738989000]
        - ["bb",2.2,3.2,1590738992000]
  -
    id: 14
    desc: 拼接条件-timestamp
    inputs:
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 timestamp"]
        indexs: ["index1:c6:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01",1590738989000]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02",1590738990000]
      -
        columns : ["c1 string","c2 float","c3 double","c4 timestamp","c5 date","c6 timestamp"]
        indexs: ["index1:c6:c4"]
        rows:
          - ["aa",2.1,3.1,1590738989000,"2020-05-01",1590738989000]
          - ["bb",2.2,3.2,1590738990000,"2020-05-02",1590738990000]
          - ["bb",2.2,3.2,1590738992000,"2020-05-02",1590738990000]
          - ["bb",2.2,3.2,1590738991000,"2020-05-02",1590738990000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c6={1}.c6;
    expect:
      columns : ["c1 string","c2 float","c3 double","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2.1,3.1,1590738989000]
        - ["bb",2.2,3.2,1590738992000]
  -
    id: 15
    desc: 不同类型的列作为拼接条件
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,2,1590738989000]
          - ["bb",21,21,1590738990000]
          - ["bb",21,21,1590738992000]
          - ["bb",21,21,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c2={1}.c3;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,2,1590738989000]
        - ["bb",21,21,1590738992000]
  -
    id: 16
    desc: 多个拼接条件
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",21,32,1590738993000]
          - ["bb",21,31,1590738992000]
          - ["bb",21,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c2={1}.c2 and {0}.c3={1}.c3;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 17
    desc: 不等值拼接
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",21,32,1590738993000]
          - ["bb",21,31,1590738992000]
          - ["bb",21,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3<{1}.c3;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,32,1590738993000]
        - ["bb",21,32,1590738993000]
  -
    id: 17
    desc: order by 限定列的范围-常量
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",21,32,1590738993000]
          - ["bb",21,31,1590738992000]
          - ["bb",21,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3={1}.c3 and {1}.c3>10;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,null,null]
        - ["bb",21,31,1590738992000]
  -
    id: 18
    desc: order by 限定列的范围-变量
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c2:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",22,31,1590738990000]
          - ["bb",21,32,1590738993000]
          - ["bb",22,31,1590738992000]
          - ["bb",22,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3={1}.c3 and {0}.c2<{1}.c2;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,null,null]
        - ["bb",21,31,1590738992000]
  -
    id: 19
    desc: 拼接条件中有空串
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["",2,3,1590738989000]
          - ["bb",22,31,1590738990000]
          - ["ab",21,32,1590738993000]
          - ["bb",22,31,1590738992000]
          - ["bb",22,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["",2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 19
    desc: 拼接条件中有null
    tags: ["TODO", "@chenjing", "BUG"]
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - [NULL,2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - [NULL,2,3,1590738989000]
          - ["bb",22,31,1590738990000]
          - ["ab",21,32,1590738993000]
          - ["bb",22,31,1590738992000]
          - ["bb",22,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c1={1}.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - [null,2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 20
    desc: 结合limit
    tags: ["TODO", "remove @zhaowei"]
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c3:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c3:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",41,31,1590738992000]
          - ["bb",41,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c3={1}.c3 limit 1;
    expect:
      rows:
        - ["aa",2,3,1590738989000]
  -
    id: 21
    desc: 三表拼表
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738992000]
          - ["bb",41,121,1590738991000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["aa",21,131,1590738992000]
          - ["aa",41,121,1590738991000]
          - ["bb",41,121,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c4,{2}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c1={1}.c1 last join {2} order by {2}.c4 on {0}.c1={2}.c1;
    expect:
      columns : ["c1 string","c2 int","c4 timestamp","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,1590738989000,1590738992000]
        - ["bb",21,1590738992000,1590738991000]
  -
    id: 22
    desc: 拼接条件不是索引列
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
          - ["bb",21,31,1590738992000]
          - ["bb",21,31,1590738991000]
    sql: select {0}.c1,{0}.c2,{1}.c3,{1}.c4 from {0} last join {1} ORDER BY {1}.c4 on {0}.c2={1}.c2;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,3,1590738989000]
        - ["bb",21,31,1590738992000]
  -
    id: 23
    desc: 使用表别名
    inputs:
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,3,1590738989000]
          - ["bb",21,31,1590738990000]
      -
        columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
        indexs: ["index1:c1:c4"]
        rows:
          - ["aa",2,13,1590738989000]
          - ["bb",21,131,1590738990000]
          - ["bb",41,121,1590738991000]
          - ["bb",31,141,1590738992000]
    sql: select t1.c1,t1.c2,t2.c3,t2.c4 from {0} as t1 last join {1} as t2 ORDER BY t2.c2 on t1.c1=t2.c1;
    expect:
      columns : ["c1 string","c2 int","c3 bigint","c4 timestamp"]
      order: c1
      rows:
        - ["aa",2,13,1590738989000]
        - ["bb",21,121,1590738991000]