db: test_zw
debugs: []
cases:
  -
    id: 0
    desc: 简单rows window
    inputs:
      -
        columns: ["id int", "c1 string","c6 double","c7 timestamp"]
        indexs: ["index1:c1:c7"]
        rows:
          - [1, "aa", 1.0, 1590738990000]
          - [2, "aa", 2.0, 1590738991000]
          - [3, "aa", 3.0, 1590738992000]
          - [4, "aa", 4.0, 1590738993000]
          - [5, "bb", 5.0, 1590738994000]
          - [6, "bb", 6.0, 1590738995000]
          - [7, "bb", 7.0, 1590738996000]
          - [8, "bb", 8.0, 1590738997000]
          - [9, "bb", 9.0, 1590738998000]
          - [10, "cc", 1.0, 1590738993000]
          - [11, "cc", 2.0, 1590738994000 ]
          - [12, "cc", 3.0, 1590738995000 ]
          - [13, "cc", 4.0, 1590738996000 ]
          - [14, "cc", 5.0, 1590738997000 ]
          - [15, "dd", 6.0, 1590738998000 ]
          - [16, "dd", 7.0, 1590738999000 ]
    sql: |
      SELECT id, c1, c6, c7,  min(c6) OVER w1 as w1_c6_min, count(id) OVER w1 as w1_cnt FROM {0} WINDOW
      w1 AS (PARTITION BY {0}.c1 ORDER BY {0}.c7 ROWS_RANGE BETWEEN 2s PRECEDING AND CURRENT ROW);
    expect:
      order: id
      columns: ["id int", "c1 string", "c6 double", "c7 timestamp", "w1_c6_min double","w1_cnt bigint"]
      rows:
        - [ 1, "aa", 1.0, 1590738990000, 1.0, 1]
        - [ 2, "aa", 2.0, 1590738991000, 1.0, 2]
        - [ 3, "aa", 3.0, 1590738992000, 1.0, 3]
        - [ 4, "aa", 4.0, 1590738993000, 2.0, 3]
        - [ 5, "bb", 5.0, 1590738994000, 5.0, 1]
        - [ 6, "bb", 6.0, 1590738995000, 5.0, 2]
        - [ 7, "bb", 7.0, 1590738996000, 5.0, 3]
        - [ 8, "bb", 8.0, 1590738997000, 6.0, 3]
        - [ 9, "bb", 9.0, 1590738998000, 7.0, 3]
        - [ 10, "cc", 1.0, 1590738993000, 1.0, 1]
        - [ 11, "cc", 2.0, 1590738994000, 1.0, 2]
        - [ 12, "cc", 3.0, 1590738995000, 1.0, 3]
        - [ 13, "cc", 4.0, 1590738996000, 2.0, 3]
        - [ 14, "cc", 5.0, 1590738997000, 3.0, 3]
        - [ 15, "dd", 6.0, 1590738998000, 6.0, 1]
        - [ 16, "dd", 7.0, 1590738999000, 6.0, 2]
