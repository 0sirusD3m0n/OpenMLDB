
数据格式设计

## 方案一
![](/image/format1.png)
FVersion表示数据格式版本号, 占用一个字节  
SVersion表示schema的版本号, 占用一个字节  
Size表示整条数据大小, 占用四个字节  
BitMap表示哪个字段为NULL. 如果schema字段数为N, 占用长度为: 如果是8的倍数为N/8, 否则是N/8+1  
数据存储区域中如果是基本类型直接存储数据, 如果是字符串类型保存字符串起始位置  
字符串区域中每个字符串包含长度信息和真实内容, 其中长度信息占用两个字节  

## 方案二
字符串区域中不保存每个字符串的长度, 字符串长度通过当前字符串offset和下一个字符串offset计算得出  
![](/image/format2.png)
FVersion表示数据格式版本号, 占用一个字节  
SVersion表示schema的版本号, 占用一个字节  
Size表示整条数据大小, 占用四个字节  
BitMap表示哪个字段为NULL. 如果schema字段数为N, 占用长度为: 如果是8的倍数为N/8, 否则是N/8+1  
基本类型存储区域只存储非字符串类型   
字符串地址存储区域存储字符串的实际地址  
字符串数据存储区域存储的是字符串实际内容  
